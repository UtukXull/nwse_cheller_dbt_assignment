version: 2

models:
  - name: mrt_dim_date
    description: General data warehouse date dimension.
    columns:
      - name: date_id
        description: Unique identifier for each specific date constructed from the date itself (YYYYMMDD).
        tests:
          - unique
          - not_null
  - name: mrt_salesforce__dim_account
    description: Dimensional Salesforce account data
    columns:
      - name: account_id
        description: Unique identifier for the Salesforce account.
        tests:
          - unique
          - not_null
  - name: mrt_salesforce__dim_opportunity_history
    description: Dimensional Salesforce opportunity history data
    columns:
      - name: opportunity_id
        description: Unique identifier for the Salesforce opportunity.
        tests:
          - not_null
      - name: date_opportunity_record_valid_from
        description: The start of the validity period for the historical opportunity record.
        tests:
          - not_null
    tests:
      - dbt_utils.unique_combination_of_columns:
          combination_of_columns:
            - opportunity_id
            - date_opportunity_record_valid_from
  - name: mrt_salesforce__dim_opportunity
    description: Dimensional Salesforce opportunity data
    columns:
      - name: opportunity_id
        description: Unique identifier for the Salesforce opportunity.
        tests:
          - unique
          - not_null
  - name: mrt_salesforce__dim_user
    description: Dimensional Salesforce user data
    columns:
      - name: user_id
        description: Unique identifier for the Salesforce user.
        tests:
          - unique
          - not_null

  - name: mrt_salesforce_fact_opportunity_history
    description: Fact table for Salesforce opportunity history.
    columns:
      - name: opportunity_id
        description: Unique identifier for the Salesforce opportunity.
        tests:
          - not_null
      - name: date_opportunity_record_valid_from
        description: The start of the validity period for the historical opportunity record.
        tests:
          - not_null
    tests:
      - dbt_utils.unique_combination_of_columns:
          combination_of_columns:
            - opportunity_id
            - date_opportunity_record_valid_from
  - name: mrt_salesforce_fact_opportunity
    description: Fact table for Salesforce opportunity.
    columns:
      - name: opportunity_id
        description: Unique identifier for the Salesforce opportunity.
        tests:
          - unique
          - not_null
